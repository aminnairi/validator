"use strict";exports.Validator=class{constructor(e){this.rules=e}validate(e){const r=Object.entries(this.rules).reduce(((r,[t,i])=>{const n=i.split("|").map((e=>e.trim())),s=e[t],o=n.reduce(((i,n)=>{if("required"===n)return null==s?{...i,[t]:[...i[t]||[],t+" is required."]}:i;if("integer"===n)return null==s||Number.isInteger(Number(s))?i:{...i,[t]:[...i[t]||[],t+" should be an integer."]};if("email"===n){const e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/u;return"string"!=typeof s||e.test(s)?i:{...i,[t]:[...i[t]||[],t+" should be a valid email."]}}if("password"===n){const e=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*\W).{8,}/u;return"string"!=typeof s||e.test(s)?i:{...i,[t]:[...i[t]||[],t+" should contain at least digits, lower & upper letters, symbols and at least 8 characters."]}}if("date"===n)return null!=s&&Number.isNaN(Date.parse(s))?{...i,[t]:[...i[t]||[],t+" should be a valid date."]}:i;if("string"===n)return"string"!=typeof s?{...i,[t]:[...i[t]||[],t+" should be a string."]}:r;if(n.startsWith("same")){const[,r]=n.split(":");if(void 0===r)throw new Error('No value defined for the rule "same".');const o=r,u=e[o];return null!=s&&u!==s?{...i,[t]:[...i[t]||[],`${t} should be the same as ${o}.`]}:i}if(n.startsWith("minimum")){const[,e]=n.split(":");if(void 0===e)throw new Error('No value defined for the rule "minimum".');const r=Number(e);if(!Number.isFinite(r))throw new Error('No number defined for the rule "minimum".');const o=r,u=typeof s;if("undefined"!==u&&null!==s){if("number"==typeof s&&s<o)return{...i,[t]:[...i[t]||[],`${t} should be at least equals to ${o}.`]};if("string"===u&&s.length<o)return{...i,[t]:[...i[t]||[],`${t} should have at least ${o} characters.`]}}return i}if(n.startsWith("maximum")){const[,e]=n.split(":");if(void 0===e)throw new Error('No value defined for the rule "maximum".');const r=Number(e);if(!Number.isFinite(r))throw new Error('No number defined for the rule "maximum".');const o=r,u=typeof s;if("undefined"!==u&&null!==s){if("number"===u&&s>o)return{...i,[t]:[...i[t]||[],`${t} should be at most equals to ${o}.`]};if("string"===u&&s.length>o)return{...i,[t]:[...i[t]||[],`${t} should have at most ${o} characters.`]}}return i}if(n.startsWith("in")){const[,e]=n.split(":");if(void 0===e)throw new Error('No value defined for the rule "in".');const r=e.split(",").map((e=>e.trim()));return null==s||r.includes(s)?i:{...i,[t]:[...i[t]||[],`${t} should be one of the following: ${r.join(", ")}.`]}}throw new Error(`Unrecognized rule: ${n}.`)}),{});return{...r,...o}}),{});return 0===Object.keys(r).length?null:r}};
